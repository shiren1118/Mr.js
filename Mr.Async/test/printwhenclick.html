<!DOCTYPE html>
<html>
	<head>
		<script type="text/javascript" src="../Mr.async.js"></script>
		<script type="text/javascript" src="parser.js"></script>
		<script type="text/javascript">
			var code = UglifyJS.parse('var i = 0;while(i++ < 10){if(i == 5)break;console.log(i + 1);}');

			function print(val){
				var li = document.createElement('li');
				li.innerHTML = val;
				document.getElementById('output').appendChild(li);
			}
			
			function $await(elem, eventType, handler){
				var once = function(evt){
					handler.call(this, evt);
					this.removeEventListener(eventType, once, false);						
				};
				elem.addEventListener(eventType, once, false);
			}

			function Fib(){
				var a = 0, current = 1, count = 0;
				this.next = function(){
					if(count++ == 0) return 0;
					else if(count++ == 1) return 1;
					var b = a;
					a = current;
					return current = a + b;
				};
			}
			
			function printWhenClick(){
				Mr.asynIterator(new Fib(), function(val, idx){
					var _ = this;
					$await(document.body, 'click', function(evt){
						print(val);
						_.next();
					});
				});
			}

			window.onload = function(){
				// printWhenClick();
				function while1(){
					var i = 0;
					Mr.asynIterator(Mr.infinite(), function(){
						if(i++ < 10){
							if(i == 5) return Mr.CONTINUE;
							console.log(i + 1);
							this.next();
						}else{
							return Mr.BREAK;
						}
					});

					i = 0;while(i++ < 10){if(i == 5)continue;console.log(i + 1);}
				}

				function for1(){
					for(var i = 0 ; i < 10 ; i++){
						if(i == 5) continue;
						console.log(i + 1);
					}
					
					var i = 0;
					Mr.asynIterator(Mr.infinite(), function(){
						if(i < 10){
							if(i == 5)
							{
								i++;
								return Mr.CONTINUE;
							}

							console.log(i + 1);
							i++;
							this.next();
						}else{
							return Mr.BREAK;
						}
					});
				}
				
				function doWhile(){
					var i = 0;
					do{
						if(i == 5) continue;
						console.log(i + 1);
					}while(i++ < 10);

					i = 0;
					Mr.asynIterator(Mr.infinite(), function(){
						if(i == 5){
							i++;
							return Mr.CONTINUE;
						}
						console.log(i + 1);
						if(i++ < 10){
							this.next();
						}else{
							return Mr.BREAK;
						}
					});
				}
				doWhile();
			};
		</script>
	</head>
	<body style="height:1000px;">
		<ul id="output">
			
		</ul>
	</body>
</html>

